var ampDeviceId;
var ampWaitingFunc;

(function(e,t){var n=e.amplitude||{_q:[],_iq:{}};var r=t.createElement("script")
;r.type="text/javascript";r.async=true
;r.src="https://cdn.amplitude.com/libs/amplitude-4.5.2-min.gz.js"
;r.onload=function(){if(e.amplitude.runQueuedFunctions){
    e.amplitude.runQueuedFunctions()}else{
    console.log("[Amplitude] Error: could not load SDK")}}
;var i=t.getElementsByTagName("script")[0];i.parentNode.insertBefore(r,i)
;function s(e,t){e.prototype[t]=function(){
    this._q.push([t].concat(Array.prototype.slice.call(arguments,0)));return this}}
    var o=function(){this._q=[];return this}
    ;var a=["add","append","clearAll","prepend","set","setOnce","unset"]
    ;for(var u=0;u<a.length;u++){s(o,a[u])}n.Identify=o;var c=function(){this._q=[]
        ;return this}
    ;var l=["setProductId","setQuantity","setPrice","setRevenueType","setEventProperties"]
    ;for(var p=0;p<l.length;p++){s(c,l[p])}n.Revenue=c
    ;var d=["init","logEvent","logRevenue","setUserId","setUserProperties","setOptOut","setVersionName","setDomain","setDeviceId","setGlobalUserProperties","identify","clearUserProperties","setGroup","logRevenueV2","regenerateDeviceId","groupIdentify","logEventWithTimestamp","logEventWithGroups","setSessionId","resetSessionId"]
    ;function v(e){function t(t){e[t]=function(){
        e._q.push([t].concat(Array.prototype.slice.call(arguments,0)))}}
        for(var n=0;n<d.length;n++){t(d[n])}}v(n);n.getInstance=function(e){
        e=(!e||e.length===0?"$default_instance":e).toLowerCase()
        ;if(!n._iq.hasOwnProperty(e)){n._iq[e]={_q:[]};v(n._iq[e])}return n._iq[e]}
    ;e.amplitude=n})(window,document);

analyticsImpls.push({
    analyticsSignup: function (id) {
    },

    analyticsLogout: function () {
    },

    analyticsUserProperties: function (propertiesArray) {
        try {
            var p = ampCloneObjectForAnalytics(propertiesArray, true);
            if (!p)
                return;

            // Anytime they setup the email address we'll also add the hasEmail property
            if (p['email'])
                p['hasEmail'] = true;

            amplitude.getInstance().setUserProperties(p);
        }
        catch (e) {
        }
    },

    analyticsIncUserProperty: function (name, num) {
        try {
            var identify = new amplitude.Identify().add(name, num);
            amplitude.getInstance().identify(identify);
        }
        catch (e) {
        }
    },

    analyticsEvent: function (name, propertiesArray, callback) {
        try {
            var p = ampCloneObjectForAnalytics(propertiesArray, false);

            // Always add timestamp to event
            p['timestamp'] = parseInt((new Date().getTime())/1000);

            if (!p['referrer'])
                p['referrer'] = document.referrer;

            if (!p['from'])
                p['from'] = window.location.href;

            amplitude.getInstance().logEvent(name, p, callback);
        }
        catch (e) {
        }
    },

    analyticsRevenue: function (productId, price, transactionId, coupon) {
        try {
            var revenue = new amplitude.Revenue().setProductId(productId).setPrice(price);
            amplitude.getInstance().logRevenueV2(revenue);
        }
        catch (e) {
        }
    },

    analyticsGetDeviceId: function (func) {
        try {
            if (ampDeviceId)
                func(ampDeviceId);
            else
                ampWaitingFunc = func;
        }
        catch (e) {
        }
    }
});

function ampCloneObjectForAnalytics(o, checkNoKeys) {
    var temp = {};
    var foundKeys = false;
    if (o) {
        for (var key in o) {
            temp[key] = o[key];
            foundKeys = true;
        }
    }

    if (checkNoKeys && !foundKeys)
        return undefined;

    return temp;
}