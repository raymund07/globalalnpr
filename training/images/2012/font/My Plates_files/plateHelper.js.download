(function(){'use strict';var arrayHelper=TxDMV.Lpot.MyPlates.Web.Services.arrayHelper;function getMatchingVehicleTypesWithinFamily(vehicleTypeId,family,backgroundOnly){var list=[];if(!family.vehicleTypes)return list;family.vehicleTypes.forEach(function(vehicleType){if(vehicleType.vehicleTypeId===vehicleTypeId){if(backgroundOnly&&vehicleType.maxCharacterLength===0){list.push(vehicleType);}
else if(vehicleType.maxCharacterLength>0){list.push(vehicleType);}}});return arrayHelper.sort(list,'maxCharacterLength');}
function getPricingText(plate,backgroundOnly){var createTerms=function(terms){var str='';if(!terms){console.log('Plate missing terms',plate);return str;}
terms.forEach(function(item){if(str.length>0)str+='\n';str+=item.term+' Year'+((item.term===1)?'':'s');str+=': $'+item.price;});return str;};var str='';var isFirst=true;var matchingVehicleTypes=getMatchingVehicleTypesWithinFamily(plate.vehicleTypeId,plate.family,backgroundOnly);matchingVehicleTypes.forEach(function(item){str+='\n\n* '+((isFirst)?'1-':'')+item.maxCharacterLength+' Characters *\n';str+=createTerms(item.terms);isFirst=false;});return str;}
function getMinimumAnnualPriceForLongestTerm(plate,messageCharacterLength,backgroundOnly){var getLongestTerm=function(item){if(!item.terms||item.terms.length===0)return null;return item.terms.slice(-1)[0];};var getFormattedPrice=function(term){if(!term)return'';var price=term.price/term.term;if(price!=parseInt(price))price=price.toFixed(2);return price;};var matchingVehicleTypes=getMatchingVehicleTypesWithinFamily(plate.vehicleTypeId,plate.family,backgroundOnly);if(matchingVehicleTypes.length===0)return'';var messageLengthPlate=getPlateBasedOnMessageLength(matchingVehicleTypes,messageCharacterLength,backgroundOnly);var term=getLongestTerm(messageLengthPlate);return getFormattedPrice(term);}
function getPlateBasedOnMessageLength(matchingVehicleTypes,messageCharacterLength,backgroundOnly){if(matchingVehicleTypes.length===1)return matchingVehicleTypes[0];for(var i=0,len=matchingVehicleTypes.length;i<len;i++){var item=matchingVehicleTypes[i];if(backgroundOnly&&item.maxCharacterLength===0)return item;if(messageCharacterLength<=item.maxCharacterLength)return item;}
return matchingVehicleTypes[matchingVehicleTypes.length-1];}
function getOrderButtonText(categoryId){if(categoryId==11||categoryId==12)
return"How To Apply";if(categoryId==13||categoryId==14||categoryId==15)
return"Pre-order Now";return"Order Now";}
TxDMV.Lpot.MyPlates.Web.Services.plateHelper={getMinimumAnnualPriceForLongestTerm:getMinimumAnnualPriceForLongestTerm,getPricingText:getPricingText,getOrderButtonText:getOrderButtonText};}());